<!DOCTYPE html>
<html>
<!--
Copyright [2024] [Michael Peter Christen, mc@yacy.net]

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<head>
  <title>Transcript Display</title>
</head>
<body>
  <h1>Transcript Display</h1>
  <div id="transcript-container"></div>

  <script>
    let latestChunkId = null;
    let transcriptContainer = document.getElementById('transcript-container');

    function getLatestTranscript() {
      fetch('http://localhost:5040/get_latest_transcript?sentences=true')
        .then(response => response.json())
        .then(data => {
          const chunkId = data.chunk_id;
          const transcript = data.transcript;

          if (chunkId !== latestChunkId) {
            // New chunk ID, add a new line to the transcript container
            const newLine = document.createElement('div');
            newLine.textContent = transcript;
            transcriptContainer.appendChild(newLine);
            latestChunkId = chunkId;
          } else {
            // Same chunk ID, update the existing transcript
            transcriptContainer.lastChild.textContent = transcript;
          }
        })
        .catch(error => console.error('Error fetching latest transcript:', error));
    }

    // Fetch the latest transcript every second
    setInterval(getLatestTranscript, 1000);
  </script>
</body>
</html>